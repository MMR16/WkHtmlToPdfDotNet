using Microsoft.AspNetCore.Mvc;
using WkHtmlToPdfDotNet;
using WkHtmlToPdfDotNet.Contracts;

namespace WkHtmlToPdf.Controllers
{
    [ApiController]
    [Route("[controller]")]
    public class WeatherForecastController : ControllerBase
    {
        private readonly IConverter _converter;
        private readonly IWebHostEnvironment _env;

        public WeatherForecastController(IConverter converter, IWebHostEnvironment env)
        {
            _converter = converter;
            _env = env;
        }

        [HttpGet(Name = "WkHtmlToPdf")]
        public IActionResult Get([FromQuery] string? name, [FromQuery] int? age, [FromQuery] Uri ? image)
        {
            //image.IsAbsoluteUri = true;


        // Combine the web-root path with your css folder + filename
        var cssPath = Path.Combine(_env.WebRootPath, "css", "QuillEditor.css");
            var html = @$"

                                    <!DOCTYPE html>
                                    <html lang=""en"">
                                    <head>
                                        <meta charset=""UTF-8"">
                                        <meta name=""viewport"" content=""width=device-width, initial-scale=1.0"">
                                 <link  rel=""stylesheet"" href=""{cssPath}"">
                                        <title>Document</title>
                                       <style>
                                            h1{{
                                                color: red;
                                                margin: 50px 0 20px 450px;
                                            }}

                                            h2{{
                                                color: blue;
                                                margin: 0 0 0 200px;
                                            }}
                                        </style> 
                                    </head>
                                    <body>
                                        <h1 >{name}</h1>                         
                                        <h1 >{age}</h1>

                                        <h2>Try Quest Pdf</h2>
                                        <div>
                                            <p style=""font-weight: bold; font-size: larger;"">
                                                Lorem ipsum dolor sit amet consectetur adipisicing elit. Molestias pariatur laboriosam esse enim eveniet accusantium aliquid quaerat modi perferendis soluta nulla est odit qui nobis, voluptas odio dignissimos aperiam? Amet?
                                            </p>
                                        </div>
                                        <div>
                                        <br>
                                            <br>
                                            <br>
                                {(image != null? $"<img src=\"{image}\" alt=\"ea\" />": string.Empty)}
                                        </div>
<br>
<br>
<br>
<br>
<br>
<br>

                <div>


     <h1 class=""ql-align-right""><strong style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-large"">ٱللُّغَةُ ٱلْعَرَبِيَّة</strong></h1><h2 class=""ql-align-right""><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-large""> هي أكثر اللغات </span><a href=""https://ar.wikipedia.org/wiki/%D9%84%D8%BA%D8%A7%D8%AA_%D8%B3%D8%A7%D9%85%D9%8A%D8%A9"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-large"">السامية</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-large""> تحدثًا،</span></h2><p class=""ql-align-right""><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> وإحدى أكثر اللغات انتشاراً في العالم، يتحدثها أكثر من 467 مليون نسمة.</span><sup style=""background-color: initial; color: rgb(51, 102, 204);"" class=""ql-size-huge""><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%B9%D8%B1%D8%A8%D9%8A%D8%A9#cite_note-4"" rel=""noopener noreferrer"" target=""_blank"">[4]</a></sup><sup style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge"">(</sup><sup style=""background-color: initial; color: rgb(51, 102, 204);"" class=""ql-size-huge""><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%B9%D8%B1%D8%A8%D9%8A%D8%A9#fn_1"" rel=""noopener noreferrer"" target=""_blank"">1</a></sup><sup style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge"">)</sup><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> ويتوزع متحدثوها في </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%88%D8%B7%D9%86_%D8%A7%D9%84%D8%B9%D8%B1%D8%A8%D9%8A"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">الوطن العربي</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge"">، بالإضافة إلى العديد من المناطق الأخرى المجاورة </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D8%A3%D9%87%D9%88%D8%A7%D8%B2"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">كالأحواز</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D8%AA%D8%B1%D9%83%D9%8A%D8%A7"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">وتركيا</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D8%AA%D8%B4%D8%A7%D8%AF"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">وتشاد</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D9%85%D8%A7%D9%84%D9%8A"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">ومالي</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D8%B3%D9%86%D8%BA%D8%A7%D9%84"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">والسنغال</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D8%A5%D8%B1%D8%AA%D8%B1%D9%8A%D8%A7"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">وإرتيريا</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D8%A5%D8%AB%D9%8A%D9%88%D8%A8%D9%8A%D8%A7"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">وإثيوبيا</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D8%AC%D9%86%D9%88%D8%A8_%D8%A7%D9%84%D8%B3%D9%88%D8%AF%D8%A7%D9%86"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">وجنوب السودان</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D8%A5%D9%8A%D8%B1%D8%A7%D9%86"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">وإيران</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge"">. وبذلك فهي تحتل المركز الرابع أو الخامس من حيث اللغات الأكثر انتشارًا في العالم،</span><sup style=""background-color: initial; color: rgb(51, 102, 204);"" class=""ql-size-huge""><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%B9%D8%B1%D8%A8%D9%8A%D8%A9#cite_note-5"" rel=""noopener noreferrer"" target=""_blank"">[5]</a><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%B9%D8%B1%D8%A8%D9%8A%D8%A9#cite_note-6"" rel=""noopener noreferrer"" target=""_blank"">[6]</a><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%B9%D8%B1%D8%A8%D9%8A%D8%A9#cite_note-7"" rel=""noopener noreferrer"" target=""_blank"">[7]</a></sup><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> وهي تحتل المركز الثالث تبعًا لعدد الدول التي تعترف بها كلغة رسمية؛ إذ تعترف بها 27 دولة لغةً رسميةً،</span><sup style=""background-color: initial; color: rgb(51, 102, 204);"" class=""ql-size-huge""><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%B9%D8%B1%D8%A8%D9%8A%D8%A9#cite_note-8"" rel=""noopener noreferrer"" target=""_blank"">[8]</a></sup><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> واللغة الرابعة من حيث عدد المستخدمين على الإنترنت.</span><sup style=""background-color: initial; color: rgb(51, 102, 204);"" class=""ql-size-huge""><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%B9%D8%B1%D8%A8%D9%8A%D8%A9#cite_note-9"" rel=""noopener noreferrer"" target=""_blank"">[9]</a></sup><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> اللغةُ العربيةُ ذات أهمية قصوى لدى </span><a href=""https://ar.wikipedia.org/wiki/%D9%85%D8%B3%D9%84%D9%85"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">المسلمين</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge"">، فهي عندَهم لغةٌ مقدسة إذ إنها لغة </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%82%D8%B1%D8%A2%D9%86"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">القرآن</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge"">، وهي لغةُ </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D8%B5%D9%84%D8%A7%D8%A9_%D9%81%D9%8A_%D8%A7%D9%84%D8%A5%D8%B3%D9%84%D8%A7%D9%85"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">الصلاة</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> وأساسيةٌ في القيام بالعديد من العبادات والشعائرِ </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D8%A5%D8%B3%D9%84%D8%A7%D9%85"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">الإسلامية</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge"">.</span><sup style=""background-color: initial; color: rgb(51, 102, 204);"" class=""ql-size-huge""><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%B9%D8%B1%D8%A8%D9%8A%D8%A9#cite_note-10"" rel=""noopener noreferrer"" target=""_blank"">[10]</a><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%B9%D8%B1%D8%A8%D9%8A%D8%A9#cite_note-11"" rel=""noopener noreferrer"" target=""_blank"">[11]</a></sup><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> العربيةُ هي أيضاً لغة شعائرية رئيسية لدى عدد من الكنائس </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%85%D8%B3%D9%8A%D8%AD%D9%8A%D8%A9"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">المسيحية</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> في الوطن العربي، كما كُتبَت بها كثير من أهمِّ الأعمال الدينية والفكرية </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%8A%D9%87%D9%88%D8%AF%D9%8A%D8%A9"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">اليهودية</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> في </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D8%B9%D8%B5%D9%88%D8%B1_%D8%A7%D9%84%D9%88%D8%B3%D8%B7%D9%89"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">العصور الوسطى</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge"">. ارتفعتْ مكانةُ اللغةِ العربية إثْرَ انتشارِ </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D8%A5%D8%B3%D9%84%D8%A7%D9%85"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">الإسلام</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> بين الدول إذ أصبحت لغة </span><a href=""https://ar.wikipedia.org/wiki/%D8%B3%D9%8A%D8%A7%D8%B3%D8%A9"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">السياسة</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> والعلم والأدب لقرون طويلة في الأراضي التي حكمها </span><a href=""https://ar.wikipedia.org/wiki/%D9%85%D8%B3%D9%84%D9%85"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">المسلمون</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge"">. وللغة العربية تأثير مباشر وغير مباشر على كثير من اللغات الأخرى في </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D8%B9%D8%A7%D9%84%D9%85_%D8%A7%D9%84%D8%A5%D8%B3%D9%84%D8%A7%D9%85%D9%8A"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">العالم الإسلامي</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge"">، </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%AA%D8%B1%D9%83%D9%8A%D8%A9"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">كالتركية</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D9%81%D8%A7%D8%B1%D8%B3%D9%8A%D8%A9"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">والفارسية</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D9%84%D8%BA%D8%A7%D8%AA_%D8%A3%D9%85%D8%A7%D8%B2%D9%8A%D8%BA%D9%8A%D8%A9"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">والأمازيغية</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D9%83%D8%B1%D8%AF%D9%8A%D8%A9_(%D8%AA%D9%88%D8%B6%D9%8A%D8%AD)"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">والكردية</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%A3%D8%B1%D8%AF%D9%8A%D8%A9"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">والأردية</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D9%85%D8%A7%D9%84%D9%8A%D8%B2%D9%8A%D8%A9"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">والماليزية</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%A5%D9%86%D8%AF%D9%88%D9%86%D9%8A%D8%B3%D9%8A%D8%A9"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">والإندونيسية</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%A3%D9%84%D8%A8%D8%A7%D9%86%D9%8A%D8%A9"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">والألبانية</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> وبعض اللغات الإفريقية الأخرى مثل </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D9%87%D9%88%D8%B3%D9%8A%D8%A9"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">الهاوسا</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%B3%D9%88%D8%A7%D8%AD%D9%84%D9%8A%D8%A9"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">والسواحيلية</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%AA%D8%AC%D8%B1%D9%8A%D8%A9"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">والتجرية</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%A3%D9%85%D9%87%D8%B1%D9%8A%D8%A9"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">والأمهرية</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%B5%D9%88%D9%85%D8%A7%D9%84%D9%8A%D8%A9"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">والصومالية</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge"">، وبعض اللغات الأوروبية وخاصةً </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D8%A8%D8%AD%D8%B1_%D8%A7%D9%84%D8%A3%D8%A8%D9%8A%D8%B6_%D8%A7%D9%84%D9%85%D8%AA%D9%88%D8%B3%D8%B7"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">المتوسطية</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%A5%D8%B3%D8%A8%D8%A7%D9%86%D9%8A%D8%A9"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">كالإسبانية</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%A8%D8%B1%D8%AA%D8%BA%D8%A7%D9%84%D9%8A%D8%A9"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">والبرتغالية</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D9%85%D8%A7%D9%84%D8%B7%D9%8A%D8%A9"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">والمالطية</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge""> </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%B5%D9%82%D9%84%D9%8A%D8%A9"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">والصقلية</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge"">؛ ودخلت الكثير من مصطلحاتها في اللغة الإنجليزية واللغات الأخرى، مثل أدميرال والتعريفة والكحول والجبر وأسماء النجوم. كما أنها تُدرَّس بشكل رسمي أو غير رسمي في الدول الإسلامية والدول الإفريقية المحاذية </span><a href=""https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D9%88%D8%B7%D9%86_%D8%A7%D9%84%D8%B9%D8%B1%D8%A8%D9%8A"" rel=""noopener noreferrer"" target=""_blank"" style=""background-color: rgb(255, 255, 255); color: rgb(51, 102, 204);"" class=""ql-size-huge"">للوطن العربي</a><span style=""background-color: rgb(255, 255, 255); color: rgb(32, 33, 34);"" class=""ql-size-huge"">.</span></p>




</div>                      

            </body>
            </html>



";
            var doc = new HtmlToPdfDocument()
            {
                GlobalSettings = {
                ColorMode = ColorMode.Color,
                Orientation = Orientation.Portrait,
                PaperSize = PaperKind.A4},
                Objects = {new ObjectSettings() {
                                                  PagesCount = true,
                                                  HtmlContent = html,
                                                  WebSettings = { DefaultEncoding = "utf-8" },
                                                  HeaderSettings = { FontSize = 9, Right = "Page [page] of [toPage]", Line = true, Spacing = 2.812 } }}
            };
            byte[] pdf = _converter.Convert(doc);
            var fileName = $"report-{DateTime.UtcNow.AddHours(3):yyyyMMddHHmm}.pdf";
            return File(pdf, "application/pdf", fileName);
        }
    }
}
